# Результаты обучения моделей детекции (YOLO11-s / YOLO11-l / YOLO11-x)

Директория содержит результаты обучения трёх вариантов детектора YOLO11 для задачи промышленной безопасности:

- детекция людей с различными типами жилетов;
- детекция поезда;
- отделение объектов от фона (background).

Классы:
`noname`, `person_blue`, `person_gray`, `person_orange`, `person_red`, `person_white`, `train`, `background`.

---

## Содержимое папки

### Графики качества моделей

- `confusion_matrix_s.png` – нормализованная матрица ошибок для YOLO11-s  
- `confusion_matrix_l.png` – нормализованная матрица ошибок для YOLO11-l  
- `confusion_matrix_x.png` – нормализованная матрица ошибок для YOLO11-x  

По осям:  
**True** – настоящий класс объекта, **Predicted** – предсказанный моделью.  
Чем больше значений на диагонали, тем лучше модель различает классы.

- `results_s.png` – динамика лоссов и метрик для YOLO11-s  
- `results_l.png` – динамика лоссов и метрик для YOLO11-l  
- `results_x.png` – динамика лоссов и метрик для YOLO11-x  

Каждый файл содержит 10 графиков:
- `train/box_loss`, `train/cls_loss`, `train/dfl_loss` – лоссы на трейне;  
- `val/box_loss`, `val/cls_loss`, `val/dfl_loss` – лоссы на валидации;  
- `metrics/precision(B)`, `metrics/recall(B)` – точность и полнота по боксам;  
- `metrics/mAP50(B)`, `metrics/mAP50-95(B)` – mAP@0.50 и mAP@[0.50…0.95].

---

## Краткая аналитика по моделям

### Общие выводы

- Для всех трёх моделей **лоссы монотонно падают**, а кривые train/val идут близко друг к другу → переобучения нет, обучение устойчивое.
- Для всех вариантов YOLO11 итоговые значения `precision`, `recall` и `mAP` на валидации находятся в высокой зоне (мAP50 около 0.9+ по графикам).  
- Нормализованные confusion matrix показывают, что **основная масса предсказаний находится на диагонали**, то есть большинство объектов распознаются корректно.

Главные проблемы, которые видно на всех трёх матрицах:
- частичное смешение рабочих с фоном (`background`), особенно для редко встречающихся классов;
- некоторая путаница между `person_orange` и `person_red` (визуально очень похожие сигнальные жилеты);
- небольшая доля случаев, когда фон принимается за человека или наоборот — важно для снижения числа ложных тревог.

---

### YOLO11-s

Файлы: `confusion_matrix_s.png`, `results_s.png`

- Самая лёгкая модель по параметрам → хорошо подходит для **реального времени** и слабых GPU/CPU.
- Графики показывают быстрое снижение лоссов и рост метрик, при этом финальные значения чуть ниже, чем у более тяжёлых моделей (по графикам mAP50-95 немного меньше).
- В confusion matrix диагональ сильная, но доля ошибок на фоне и редких классах выше, чем у L/X.

**Когда использовать:**  
Если приоритет — скорость и низкие требования к железу, а небольшое снижение качества допустимо (например, онлайн-мониторинг с высокой частотой кадров).

---

### YOLO11-l

Файлы: `confusion_matrix_l.png`, `results_l.png`

- Компромисс между скоростью и качеством.  
- По кривым видно, что mAP и recall растут до значений, близких к YOLO11-x, при этом модель легче и быстрее.
- Confusion matrix показывает более аккуратное разделение классов по сравнению с YOLO11-s: меньше ошибок на фоне и лучше различаются цветовые классы людей.

**Когда использовать:**  
Хороший вариант по умолчанию, когда нужно сочетание **достаточно высокой точности и пригодности к развёртыванию** на производственном сервере без экстремальных требований к ресурсам.

---

### YOLO11-x

Файлы: `confusion_matrix_x.png`, `results_x.png`

- Самая тяжёлая модель, но и **наиболее точная**:  
  - графики показывают самые высокие значения mAP и стабильно высокие precision/recall;
  - матрица ошибок ближе всего к «идеальной» диагонали.
- Особенно хорошо различаются классы людей по цветам жилетов и класс `train`; ошибок с фоном меньше всего.

**Когда использовать:**  
Подходит для **оффлайн-аналитики и пилотных внедрений**, где важнее максимум качества, чем скорость. Мы используем YOLO11-x как основной детектор в MVP для анализа безопасности и формирования метрик по сменам.

---

## Выбор модели для проекта

С учётом задач проекта по промышленной безопасности:

- Критично важно **не пропускать опасные ситуации** и корректно различать роли сотрудников и поезд → для пилота и оффлайн-аналитики разумно использовать **YOLO11-x**.
- Для будущего продакшена в реальном времени возможен гибридный подход:
  - YOLO11-l на основных потоках;
  - YOLO11-s на второстепенных камерах или на слабом оборудовании;
  - дообучение/тонкая настройка под новые данные из конкретного депо.

---

## Как читать эти результаты на презентации

1. Показать тренд:  
   «На всех трёх моделях лоссы плавно снижаются, метрики растут — обучение прошло стабильно, без переобучения».

2. Показать различия:  
   «YOLO11-s — быстрая, но немного менее точная; YOLO11-l — баланс; YOLO11-x — максимальное качество, чуть более тяжёлая модель».

3. Связать с бизнес-задачей:  
   «Для заказчика это означает, что мы можем регулировать компромисс между скоростью и качеством детекции под конкретное оборудование и сценарий использования».

---
